<!DOCTYPE html>
<html lang="en">
<head>
    <!-- ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶∏‡¶¨ ‡¶Æ‡ßá‡¶ü‡¶æ ‡¶ü‡ßç‡¶Ø‡¶æ‡¶ó ‡¶è‡¶¨‡¶Ç ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ -->
    <style>
        .edit-btn {
            cursor: pointer;
            color: #0d6efd;
            text-decoration: underline;
        }
    </style>
</head>
<body class="bg-light">
    <!-- ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ HTML ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶æ‡¶ï‡¶ö‡¶æ‡¶∞ ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ -->

    <script>
        // ‡¶∏‡¶Æ‡ßç‡¶™‡¶æ‡¶¶‡¶®‡¶æ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®‡¶æ‡¶≤‡¶ø‡¶ü‡¶ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá
        let editingIndex = -1;

        // ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®‡ßá ‡¶è‡¶°‡¶ø‡¶ü ‡¶¨‡¶æ‡¶ü‡¶® ‡¶Ø‡ßã‡¶ó
        const updateTable = () => {
            const data = JSON.parse(localStorage.getItem('attendance')) || [];
            const tbody = document.getElementById('recordsBody');
            tbody.innerHTML = '';

            data.forEach((rec, index) => {
                tbody.innerHTML += `
                    <tr>
                        <td>${rec.employee}</td>
                        <td>${rec.date}</td>
                        <td class="${rec.status === 'present' ? 'text-success' : 'text-danger'}">
                            ${rec.status.toUpperCase()}
                        </td>
                        <td>${rec.overtime} hours</td>
                        <td class="edit-btn" onclick="startEditing(${index})">‚úèÔ∏è Edit</td>
                        <td class="text-danger" onclick="deleteRecord(${index})" style="cursor:pointer">üóëÔ∏è</td>
                    </tr>
                `;
            });
        }

        // ‡¶è‡¶°‡¶ø‡¶ü ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        const startEditing = (index) => {
            editingIndex = index;
            const data = JSON.parse(localStorage.getItem('attendance')) || [];
            const record = data[index];

            // ‡¶´‡¶∞‡ßç‡¶Æ ‡¶™‡¶™‡ßÅ‡¶≤‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
            document.getElementById('employeeSelect').value = record.employee;
            document.getElementById('selectedDate').value = record.date;
            document.getElementById('overtimeHours').value = record.overtime;
            
            // ‡¶¨‡¶æ‡¶ü‡¶® ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®
            document.querySelector('[onclick="markAttendance(\'present\')"]').innerHTML = 'Update ‚úÖ';
            document.querySelector('[onclick="markAttendance(\'absent\')"]').innerHTML = 'Update ‚ùå';
            document.querySelector('[onclick="recordOvertime()"]').innerHTML = 'Update ‚è∞';
        }

        // ‡¶π‡¶æ‡¶≤‡¶®‡¶æ‡¶ó‡¶æ‡¶¶ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ü‡ßá‡¶®‡¶°‡ßá‡¶®‡ßç‡¶∏ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        const markAttendance = (status) => {
            const employee = document.getElementById('employeeSelect').value;
            const date = document.getElementById('selectedDate').value;

            if(!employee || !date) {
                alert("‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶ï‡¶∞‡ßç‡¶Æ‡ßÄ ‡¶è‡¶¨‡¶Ç ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®!");
                return;
            }

            const attendanceData = JSON.parse(localStorage.getItem('attendance')) || [];
            
            if(editingIndex > -1) {
                // ‡¶è‡¶°‡¶ø‡¶ü ‡¶Æ‡ßã‡¶°
                attendanceData[editingIndex] = {
                    ...attendanceData[editingIndex],
                    employee,
                    date,
                    status
                };
            } else {
                // ‡¶®‡¶§‡ßÅ‡¶® ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø
                attendanceData.push({
                    employee,
                    date,
                    status,
                    overtime: 0
                });
            }

            localStorage.setItem('attendance', JSON.stringify(attendanceData));
            resetForm();
            updateTable();
        }

        // ‡¶π‡¶æ‡¶≤‡¶®‡¶æ‡¶ó‡¶æ‡¶¶ ‡¶∞‡ßá‡¶ï‡¶∞‡ßç‡¶° ‡¶ì‡¶≠‡¶æ‡¶∞‡¶ü‡¶æ‡¶á‡¶Æ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        const recordOvertime = () => {
            const employee = document.getElementById('employeeSelect').value;
            const date = document.getElementById('selectedDate').value;
            const hours = document.getElementById('overtimeHours').value;

            if(!employee || !date || !hours) {
                alert("‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶∏‡¶¨ ‡¶´‡¶ø‡¶≤‡ßç‡¶° ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®!");
                return;
            }

            const attendanceData = JSON.parse(localStorage.getItem('attendance')) || [];
            const index = attendanceData.findIndex(rec => 
                rec.employee === employee && rec.date === date
            );

            if(index === -1) {
                alert("‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶â‡¶™‡¶∏‡ßç‡¶•‡¶ø‡¶§‡¶ø ‡¶∞‡ßá‡¶ï‡¶∞‡ßç‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®!");
                return;
            }

            attendanceData[index].overtime = parseInt(hours);
            localStorage.setItem('attendance', JSON.stringify(attendanceData));
            resetForm();
            updateTable();
        }

        // ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        const deleteRecord = (index) => {
            if(confirm("‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶è‡¶á ‡¶∞‡ßá‡¶ï‡¶∞‡ßç‡¶°‡¶ü‡¶ø ‡¶Æ‡ßÅ‡¶õ‡¶§‡ßá ‡¶ö‡¶æ‡¶®?")) {
                const attendanceData = JSON.parse(localStorage.getItem('attendance')) || [];
                attendanceData.splice(index, 1);
                localStorage.setItem('attendance', JSON.stringify(attendanceData));
                updateTable();
            }
        }

        // ‡¶´‡¶∞‡ßç‡¶Æ ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        const resetForm = () => {
            editingIndex = -1;
            document.getElementById('overtimeHours').value = '';
            document.querySelector('[onclick="markAttendance(\'present\')"]').innerHTML = 'Present ‚úÖ';
            document.querySelector('[onclick="markAttendance(\'absent\')"]').innerHTML = 'Absent ‚ùå';
            document.querySelector('[onclick="recordOvertime()"]').innerHTML = 'Save';
        }

        // ‡¶¨‡¶æ‡¶ï‡¶ø ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§
    </script>
</body>
</html>
